// Code for profiling Magma's CMTest function (imported from Magma's package/Geometry/CrvEll/cm.m)

import "/usr/local/magma/package/Geometry/CrvEll/cm.m": CMTest;

// Wrapper function: CMTest(f) returns either false,_ or true,D but we will return 0 or D

function CMDiscriminant(f)
  flag,D := CMTest(f);
  return flag select D else 0;
end function;

// code extracted from cmdisc.m verbatim

AbelianD1 := [-3, -4, -7, -8, -11, -12, -16, -19, -27, -28, -43, -67, -163];
AbelianD2 := [ -15, -20, -24, -32, -35, -36, -40, -48, -51, -52, -60, -64, -72, -75, -88, -91, -99, -100, -112, -115, -123, -147, -148, -187, -232, -235, -267, -403, -427];
AbelianD4 := [ -84, -96, -120, -132, -160, -168, -180, -192, -195, -228, -240, -280, -288, -312, -315, -340, -352, -372, -408, -435, -448, -483, -520, -532, -555, -595, -627, -708, -715, -760, -795, -928, -1012, -1435 ];
AbelianD8 := [ -420, -480, -660, -672, -840, -960, -1092, -1120, -1155, -1248, -1320, -1380, -1428, -1540, -1632, -1848, -1995, -2080, -3003, -3040, -3315 ];
AbelianD16 := [ -3360, -5280, -5460, -7392 ];
AbelianD := AbelianD1 cat AbelianD2 cat AbelianD4 cat AbelianD8 cat AbelianD16;
assert #AbelianD eq 101;

DD1000 := [[-3,-16,-163],[-15,-88,-427],[-23,-211,-907],[-39,-352,-1555],[-47,-571,-2683],[-87,-835,-4075],[-71,-1523,-5923],[-95,-1408,-7987],[-199,-2572,-10627],[-119,-2299,-13843],[-167,-3868,-15667],[-231,-3115,-19723],[-191,-3691,-20563],[-215,-4468,-30067],[-239,-6571,-34483],[-399,-5460,-35275],[-383,-8731,-37123],[-335,-7827,-48427],[-311,-8923,-38707],[-455,-9124,-58843],[-431,-11731,-61483],[-591,-11035,-85507],[-647,-15388,-90787],[-695,-12292,-111763],[-479,-25747,-93307],[-551,-18019,-103027],[-983,-19612,-103387],[-831,-17872,-126043],[-887,-29587,-166147],[-671,-21592,-137083],[-719,-35491,-133387],[-791,-21520,-164803],[-839,-29243,-222643],[-1079,-32179,-189883],[-1031,-42499,-210907],[-959,-28291,-217627],[-1487,-47251,-158923],[-1199,-37948,-289963],[-1439,-42268,-253507],[-1271,-34180,-274003],[-1151,-46147,-296587],[-1959,-42827,-301387],[-1847,-52267,-300787],[-1391,-44363,-319867],[-1319,-60748,-308323],[-2615,-57963,-462883],[-3023,-84859,-375523],[-1751,-48195,-335203],[-1511,-92779,-393187],[-1799,-64203,-389467],[-1559,-67843,-546067],[-1679,-65235,-457867],[-2711,-79699,-425107],[-2759,-74979,-532123],[-4463,-101419,-452083],[-1991,-66148,-494323],[-2591,-95068,-615883],[-2231,-97963,-586987],[-2399,-112507,-474307],[-2159,-83176,-662803],[-3863,-100291,-606643],[-2471,-97107,-647707],[-2351,-116867,-991027],[-2519,-85848,-693067],[-3527,-138883,-703123],[-3431,-115308,-958483],[-3719,-131611,-652723],[-2831,-105340,-819163],[-3119,-137867,-888427],[-3239,-138979,-821683],[-5471,-132523,-909547],[-3311,-108603,-947923],[-2999,-177211,-886867],[-4151,-171739,-951043],[-4703,-157051,-916507],[-3071,-141475,-1086187],[-6263,-187963,-1242763],[-5111,-145048,-1004347],[-4391,-172828,-1333963],[-5183,-133620,-1165483],[-3671,-170812,-1030723],[-3839,-179188,-1446547],[-3911,-207331,-1074907],[-4031,-165843,-1225387],[-4079,-252988,-1285747],[-6767,-207027,-1534723],[-5279,-216451,-1261747],[-4199,-167568,-1265587],[-6311,-261619,-1429387],[-5951,-204619,-1548523],[-4679,-236659,-1391083],[-4991,-202168,-1452067],[-5351,-254963,-1475203],[-7367,-247732,-1587763],[-6959,-251443,-1659067],[-6071,-187812,-1684027],[-5519,-272011,-1842523],[-6191,-257387,-2383747],[-5591,-306028,-1480627],[-7991,-249451,-1856563],[-5879,-316339,-1701043],[-9383,-261859,-1765003],[-13799,-341212,-1790443],[-9359,-241371,-1853923],[-6719,-310771,-2317723],[-7631,-309147,-1924267],[-8231,-344347,-2404147],[-5759,-263212,-2127283],[-5711,-376828,-1945483],[-7751,-346523,-2100547],[-15359,-359323,-1990123],[-7895,-261571,-2804587],[-8039,-426091,-2341747],[-6431,-316648,-2143843],[-7559,-454387,-2458003],[-7271,-320907,-2888923],[-6551,-379283,-2341243],[-8351,-405784,-3060787],[-9791,-537547,-2463883],[-7391,-309016,-3086323],[-8111,-474379,-2145067],[-11735,-415707,-2608747],[-14087,-415468,-2849683],[-9119,-368275,-2696467],[-11519,-516931,-2944363],[-8279,-387028,-2660443],[-19463,-527419,-2373067],[-10295,-332880,-2960323],[-9551,-494332,-2899747],[-8879,-458043,-2863963],[-12671,-510451,-3513427],[-8711,-402616,-3347227],[-9719,-643099,-3318547],[-8399,-515992,-2995507],[-8951,-518179,-2751907],[-9911,-404283,-3082123],[-15287,-579868,-2853547],[-9071,-483867,-4003267],[-9239,-592252,-3501283],[-13319,-491723,-3574363],[-11399,-574667,-3885403],[-15311,-545107,-3566347],[-11471,-672283,-3411907],[-11591,-418788,-3843907],[-14879,-680107,-4061467],[-13199,-585763,-4272403],[-13679,-601708,-4348843],[-11231,-527659,-4213003],[-17783,-663331,-4056067],[-11879,-565852,-4163443],[-22727,-700027,-4321003],[-14111,-522972,-4431667],[-10391,-629059,-3529843],[-12311,-689523,-4477267],[-20807,-794011,-4299667],[-10919,-565420,-5091403],[-25847,-906931,-4375963],[-15935,-690691,-5029627],[-12479,-723859,-4331947],[-15431,-526320,-5155243],[-12239,-840523,-3981763],[-13919,-636052,-6179947],[-40039,-802987,-4962787],[-14231,-663531,-5002363],[-12911,-754003,-4946803],[-26279,-725379,-5706787],[-15671,-909859,-4106083],[-18599,-604660,-5233243],[-24551,-933523,-5284987],[-23183,-885208,-4845163],[-13751,-898483,-5046787],[-17135,-738232,-5213587],[-14159,-971251,-5494003],[-13439,-794008,-5421067],[-18719,-1016731,-4742467],[-18431,-663123,-5976763],[-22871,-942988,-5455627],[-13991,-884299,-5222683],[-17519,-1036363,-4938187],[-15839,-730051,-6469747],[-14759,-1207267,-5891803],[-14999,-898891,-6434803],[-16631,-834859,-6079483],[-21791,-755027,-6110083],[-14951,-1169011,-7007947],[-20591,-919468,-7363987],[-25583,-1072363,-6831427],[-20951,-875352,-7402987],[-22511,-1006828,-7899523],[-16799,-1022812,-6263203],[-22271,-1290811,-7213243],[-16511,-734448,-7462123],[-26591,-1204243,-5954587],[-20279,-1043032,-6610363],[-15791,-1128643,-7268347],[-19151,-938248,-7653067],[-24071,-1193443,-7544947],[-17951,-980268,-8377363],[-19991,-1332412,-7194427],[-21311,-910539,-7206763],[-32423,-1269043,-8158987],[-17111,-1120027,-9471067],[-19031,-1420099,-6951547],[-20039,-970635,-8143843],[-18119,-1379659,-8190163],[-20471,-1152835,-8285803],[-34583,-1252828,-7982683],[-19631,-902224,-7890283],[-28151,-1663147,-7821907],[-28079,-1176232,-8141827],[-39791,-1410172,-10560643],[-20159,-1137467,-7462723],[-18191,-1208299,-8608147],[-21551,-1235147,-8124187],[-24359,-1488427,-8422747],[-22799,-984619,-8928187],[-22679,-1567147,-8386123],[-24839,-1278699,-8228707],[-24671,-1556003,-10413187],[-26039,-1219587,-8447107],[-26711,-1704931,-9388723],[-22151,-1301260,-8128387],[-44111,-1653499,-10877563],[-25751,-1028491,-9531043],[-25031,-1480588,-9119203],[-25511,-1521139,-10622683],[-24239,-1774819,-9744403],[-21479,-1203707,-9311107],[-23399,-2012371,-9142963],[-25079,-1468348,-9258307],[-26759,-1510252,-9023947],[-26351,-1192392,-9304843],[-28871,-1942387,-12424003],[-23231,-1312812,-10150387],[-37991,-1738699,-9915427],[-27599,-1382896,-10340947],[-33071,-1626227,-9842347],[-28271,-1596939,-9329203],[-25679,-1786588,-10585843],[-26519,-1174515,-10300987],[-37511,-1875067,-10573963],[-23999,-1626268,-11841523],[-29399,-1652267,-12039883],[-28391,-1438068,-9773107],[-26879,-1924963,-10804627],[-34991,-1502412,-11915467],[-27191,-2129779,-10750147],[-25871,-1371227,-12012067],[-27551,-1663523,-12316987],[-30551,-1757251,-12208267],[-39119,-1903123,-9747523],[-27719,-1491492,-12227923],[-35831,-2073403,-13380907],[-42335,-1735252,-11337307],[-40559,-1964203,-13182163],[-39431,-1316148,-14154067],[-31799,-2225308,-12819643],[-30791,-1629963,-12442123],[-27431,-2536147,-11420203],[-32759,-1668355,-13368667],[-38711,-1972588,-13038547],[-37751,-1842712,-11352763],[-36671,-2042323,-13682923],[-29279,-1503496,-13374043],[-48023,-2173819,-13325827],[-30239,-1964188,-12577987],[-44711,-1961251,-15127963],[-38111,-1802123,-13488883],[-34919,-2385739,-10422043],[-31919,-1796848,-13779187],[-83903,-2491963,-12931843],[-30719,-1559280,-14850067],[-41999,-2208259,-12573163],[-32639,-2108643,-13298443],[-38351,-2366443,-14420323],[-36839,-1773531,-13194787],[-55871,-2480851,-12249763],[-33431,-2289827,-15545203],[-33479,-2215852,-15545083],[-38279,-1804632,-13826443],[-41039,-2615227,-15375067],[-32471,-1977363,-14682523],[-48311,-2624059,-13508203],[-38471,-2018152,-17091523],[-35591,-2360203,-17301043],[-42671,-2343412,-15519667],[-47591,-2893987,-13393867],[-36431,-1644832,-16638043],[-31391,-2538883,-14493187],[-40799,-2430067,-16483987],[-36599,-2389468,-13741267],[-34151,-2171019,-16645003],[-43151,-2806123,-14378827],[-49079,-2225899,-19225243],[-51239,-2922203,-15711763],[-46079,-1982388,-17012587],[-42839,-2506363,-15231283],[-38951,-2517115,-15423787],[-59879,-2901571,-17472163],[-34271,-2127259,-19184323],[-43319,-3122491,-16997443],[-61079,-2654707,-17417107],[-53279,-2736028,-18433123],[-39311,-1972611,-19517227],[-35279,-3413227,-18535003],[-50879,-2410051,-17920963],[-56711,-3178891,-17389507],[-40871,-2358811,-19585603],[-43991,-2709643,-18509467],[-41159,-2859307,-21996307],[-40031,-3378923,-20950603],[-43559,-2082124,-19288483],[-58679,-3436507,-16992523],[-68631,-2876515,-19325707],[-44351,-3045628,-19247083],[-48671,-2466123,-19149307],[-42719,-3273148,-17947483],[-45839,-2607467,-20077843],[-62639,-3406531,-19749403],[-42479,-2076132,-19446403],[-80687,-3296347,-19988467],[-51959,-3004219,-23212963],[-49391,-3522403,-18663283],[-39959,-2364123,-20023243],[-38639,-3150331,-19385683],[-56831,-2953651,-18818347],[-46511,-3289387,-20209963],[-63071,-2431072,-20962363],[-43391,-3552859,-19603147],[-58319,-2864908,-22595203],[-44519,-3271132,-21297763],[-51119,-2836355,-20118883],[-75431,-3091483,-19573387],[-49271,-3114835,-20396707],[-56591,-3727027,-18418723],[-47879,-2328235,-23164003],[-46199,-3512147,-20523787],[-78359,-3190804,-20143363],[-52919,-3245548,-22104427],[-51911,-2905144,-22716787],[-67271,-3964699,-21507523],[-54071,-3027568,-22148107],[-52631,-3830731,-20490787],[-47519,-2715988,-20649787],[-58511,-3365867,-21618787],[-56111,-3171307,-22588603],[-75767,-4048339,-22161547],[-52751,-2861371,-24255067],[-79967,-4323427,-23539147],[-47759,-3469651,-24669283],[-66071,-3221899,-25305883],[-45239,-2565579,-24648787],[-61031,-4333099,-20743627],[-48551,-3125419,-21376987],[-53759,-4301587,-22916107],[-64391,-3210568,-24933283],[-49871,-3649612,-27829267],[-62879,-3607827,-27518467],[-50111,-4552627,-21886027],[-58799,-2768500,-28094203],[-50951,-4752043,-25351363],[-54599,-3561083,-27673963],[-64319,-4076419,-24610723],[-60791,-3343579,-27446323],[-64151,-4362331,-23679307],[-64559,-3384688,-28528963],[-56999,-4139419,-28393003],[-65639,-2838688,-26322283],[-89231,-3964283,-24310267],[-71759,-3954019,-30031747],[-82031,-4051363,-22829227],[-67199,-3214060,-27340867],[-57791,-4734043,-24067387],[-54911,-3959512,-28077883],[-53231,-4428859,-26809843],[-55319,-3214563,-28316803],[-73751,-4530067,-23737123],[-62999,-3602035,-31855387],[-59351,-4713347,-24165667],[-62711,-3738379,-26058547],[-57119,-4622323,-26708467],[-61199,-4154827,-27688747],[-105167,-4733419,-27968803],[-56759,-2875312,-30761707],[-78311,-5193563,-26780587],[-69359,-4125267,-25664563],[-58439,-4148971,-25919107],[-73295,-3752380,-35723227],[-91079,-5327723,-28406107],[-69551,-3906028,-28080427],[-78839,-4637827,-27417427],[-77159,-3498868,-30818923],[-74231,-4544908,-29641987],[-73799,-4253908,-28282963],[-61151,-5335963,-30583963],[-74711,-3594363,-31203307],[-84431,-4836892,-30407227],[-60359,-4522443,-29257243],[-61871,-4585228,-29293867],[-67031,-3460787,-32492923],[-73079,-4934428,-29489923],[-72791,-4147443,-31900507],[-71399,-5064739,-33427123],[-83279,-4130059,-28650763],[-64679,-4587148,-32558563],[-73391,-4791451,-30164227],[-70199,-5129419,-31073443],[-71279,-3580371,-32750323],[-67679,-5584828,-35251483],[-85271,-4809748,-38288083],[-87671,-5053948,-32317147],[-73559,-4232568,-32497987],[-100559,-5835139,-31667563],[-73031,-4410979,-37186843],[-81119,-5973571,-30153883],[-71111,-3507912,-36073867],[-88799,-5137747,-36876907],[-90119,-4718059,-36022603],[-151247,-6092731,-32909563],[-74399,-4246643,-34766323],[-72959,-6408691,-32806867],[-70391,-5162332,-34170403],[-63839,-5161411,-32981083],[-65159,-4097467,-35634523],[-84719,-6268987,-35307787],[-86831,-4650859,-36702187],[-79631,-5579923,-32593243],[-93959,-4629315,-37608187],[-75479,-5052947,-31578523],[-108479,-5271979,-34249363],[-102359,-6183571,-35296867],[-72071,-3728835,-41032363],[-96431,-6187708,-35309107],[-68591,-5305411,-32677507],[-93911,-5414963,-43922803],[-73631,-4724248,-36732403],[-124823,-6292339,-38708443],[-76439,-4993083,-39731323],[-109391,-6360787,-37137787],[-71231,-4464123,-37966723],[-92951,-5506099,-34840843],[-92231,-5482588,-39578947],[-87911,-6650827,-33352243],[-104279,-4648651,-40332427],[-82799,-6667027,-38254483],[-82199,-5786635,-38341363],[-124991,-5877292,-35915587],[-78119,-4046592,-43736947],[-128351,-6414587,-40298707],[-75599,-5226388,-40868683],[-141311,-6609331,-37182667],[-83879,-5251131,-40501147],[-83639,-5946979,-39824467],[-75071,-5747963,-42498787],[-80471,-6975379,-40767043],[-97991,-4450528,-43839427],[-90359,-6459499,-35862523],[-98831,-6006323,-41644387],[-92399,-5784172,-39399427],[-82631,-5441412,-40965787],[-138959,-7216252,-40544827],[-81311,-5423532,-42507067],[-90191,-6871547,-43083307],[-85679,-4583908,-40924123],[-117959,-6470419,-45287587],[-82991,-5848403,-45050923],[-125639,-6980731,-38668963],[-79439,-5015427,-45885403],[-87071,-7139971,-43522747],[-85151,-6375448,-45258427],[-107999,-6455419,-38478763],[-106679,-5138772,-40637083],[-135599,-7448491,-39867787],[-85511,-5813947,-42388963],[-99839,-7776619,-43078963],[-88871,-5966851,-50456827],[-110711,-6598348,-44573323],[-109031,-6324163,-44233963],[-115319,-7401227,-45682267],[-84839,-4633720,-47070307],[-153071,-7924403,-44310403],[-103871,-6633832,-45852643],[-110879,-6746611,-41908267],[-91031,-5872540,-47602003],[-100799,-7309123,-42827107],[-91439,-5727772,-47073163],[-88079,-7914019,-51599563],[-114215,-5302648,-43344907],[-205391,-7477123,-46336123],[-120839,-7375659,-44852347],[-113039,-8195548,-53225803],[-102959,-5687131,-49263547],[-140759,-8512732,-46884667],[-118991,-6868828,-55171603],[-116471,-7236652,-48384043],[-100751,-5238072,-50242483],[-115631,-8206972,-46767403],[-113951,-6370132,-50160427],[-122471,-8678779,-45889603],[-96599,-6423467,-53698747],[-101111,-7500707,-60408307],[-103199,-7049368,-51459787],[-129671,-7914619,-43969843],[-101639,-5405675,-58359907],[-88919,-8323891,-45824683],[-105311,-7349148,-43926667],[-98999,-7505539,-55454107],[-98159,-6383515,-50688163],[-140351,-8910379,-51521803],[-92039,-7021012,-52094947],[-130199,-8345371,-51592003],[-132599,-5186448,-59249107],[-115751,-7640092,-52806307],[-178727,-7553643,-49371067],[-126839,-9362908,-51808387],[-114071,-6190648,-50816683],[-106391,-8725459,-53784427],[-159815,-7910179,-52626907],[-97919,-8416147,-50814523],[-112439,-6217152,-57522523],[-189983,-9068971,-49528627],[-138911,-7011835,-61062787],[-149111,-9034972,-57596947],[-135959,-7063683,-59854243],[-117911,-7874131,-51065683],[-99791,-7508848,-50707603],[-109199,-9227131,-58419043],[-105551,-5750115,-58199563],[-148991,-9255691,-53210347],[-137759,-8567619,-59680987],[-112559,-7915051,-57768043],[-108239,-7263531,-61621267],[-95471,-10086707,-59880283],[-102119,-7464412,-55019827],[-131759,-9090811,-56386507],[-123959,-6639460,-59761123],[-127679,-8343091,-67637707],[-144119,-8248083,-54515827],[-110039,-9966587,-54624403],[-107159,-6754428,-65757763],[-195887,-10087228,-52577947],[-130031,-7994963,-57918547],[-107351,-8465867,-58891627],[-110759,-6125088,-65544187],[-164999,-10804603,-66690187],[-119999,-7572691,-62862067],[-112031,-9590267,-54855403],[-140999,-7723900,-66775867],[-199679,-8940499,-56086363],[-127151,-8427715,-69758203],[-112199,-9872323,-60342067],[-128999,-6579136,-57137683],[-121631,-10397419,-63345067],[-247199,-8946088,-56890387],[-104711,-8577628,-69512683],[-111359,-7581508,-60391963],[-177791,-10630987,-66345427],[-175535,-7946779,-71128843],[-115079,-10368403,-53868523],[-127391,-6787204,-64594363],[-128831,-8741363,-56668627],[-114791,-9273331,-61221763],[-121439,-10394987,-59528107],[-121679,-7429420,-59070643],[-152879,-10541731,-67093723],[-113879,-9548547,-68670067],[-138599,-8898691,-65371483],[-130751,-7501947,-63548587],[-216119,-11664619,-65187523],[-147479,-8371171,-74954587],[-144479,-11385379,-59006803],[-129359,-8257435,-60046963],[-119759,-9931627,-63351787],[-125831,-9493891,-62833387],[-136751,-10340347,-61595227],[-132431,-6433060,-60167083],[-123191,-11632459,-66021547],[-126671,-9301528,-64332907],[-137639,-10704268,-64080283],[-130919,-8632875,-74714803],[-141671,-11335123,-61582987],[-130511,-8591272,-65733427],[-164471,-11440483,-62761147],[-171839,-7811787,-66502363],[-135119,-9729619,-67477243],[-158399,-9760483,-69565507],[-232847,-10411699,-62758963],[-134111,-8221035,-72745003],[-119591,-11182363,-62212483],[-140279,-10147627,-63302803],[-133559,-10083628,-63979507],[-182591,-7546667,-70843987],[-153191,-11484859,-57989947],[-134879,-8888860,-64950307],[-154439,-11929219,-69729067],[-148799,-8930835,-74947387],[-149159,-9954748,-81792547],[-176615,-10019707,-68590267],[-138239,-11638531,-66227107],[-148511,-7885067,-72789403],[-179591,-11705443,-69640267],[-136919,-10220092,-65317267],[-167471,-10501171,-71037283],[-171311,-9270808,-77431027],[-139079,-11189212,-81250723],[-118271,-9610075,-70946467],[-143519,-12368899,-76013347],[-150839,-7609968,-72038107],[-128519,-11204539,-77518123],[-142679,-11201212,-81294907],[-142799,-11810059,-75089107],[-139919,-8622699,-79524307],[-152039,-11292227,-75061387],[-195551,-11087299,-90071083],[-156719,-11348083,-85561963],[-155039,-8709907,-69474043],[-161831,-13849603,-76185883],[-152759,-10021771,-83826667],[-247607,-12536539,-78266203],[-129191,-9957027,-76992547],[-188159,-10949131,-77100307],[-190559,-11188648,-69943603],[-186119,-13337803,-87062683],[-151511,-7958032,-80086147],[-234599,-12907387,-81289723],[-156911,-10951107,-75825667],[-160079,-11422828,-79087387],[-194255,-10082752,-74567683],[-291287,-13069051,-76430803],[-157031,-10295987,-82735843],[-147551,-12809539,-80014603],[-170519,-9117648,-78245227],[-159431,-11075059,-91032307],[-140591,-11056315,-79358827],[-224351,-12919523,-73099723],[-156239,-9488547,-81355003],[-149519,-14333419,-75830203],[-186359,-11916043,-77537923],[-142271,-11679307,-79467523],[-176231,-8223040,-80168467],[-201599,-13433491,-70658347],[-168791,-10955627,-85285267],[-177239,-12304531,-73016227],[-175559,-10626683,-83669107],[-149399,-12433468,-76959283],[-176039,-11760187,-80923627],[-165479,-12781939,-71702467],[-183431,-8868699,-91321003],[-162791,-13799827,-77313307],[-227015,-12266403,-85527187],[-145991,-12327787,-90447883],[-165359,-10739307,-81928267],[-223319,-14578699,-79385923],[-212231,-11319723,-82211563],[-155399,-14313499,-69530827],[-165959,-9249640,-78691867],[-181919,-12288268,-87331003],[-177119,-12682203,-75668587],[-163679,-13986347,-85688947],[-177551,-10447923,-97987723],[-196439,-13695739,-84638107],[-176879,-12055627,-86767003],[-184631,-13383859,-94616923],[-194711,-10237108,-100838203],[-189671,-15490171,-96295483],[-154271,-11393260,-85419427],[-147671,-15002587,-91974787],[-160991,-11238676,-92191507],[-158759,-13249699,-95914267],[-153599,-12602875,-101369227],[-185951,-14661643,-78828667],[-152591,-8969328,-100330267],[-162839,-14599891,-94306843],[-175271,-13227723,-91248763],[-269879,-13845211,-104367187],[-174191,-11465419,-91655323],[-601247,-15383227,-96572107],[-177719,-12230860,-100155427],[-276191,-15132028,-93802963],[-181991,-10634595,-96770227],[-269231,-14254252,-82751923],[-185111,-13263028,-84706603],[-188711,-16182379,-88488667],[-171239,-10955523,-104158723],[-227519,-15350812,-93347923],[-187799,-13513803,-88589587],[-224591,-13905803,-94024627],[-214079,-10292920,-105787147],[-206639,-15341971,-74149483],[-184799,-12563347,-105983707],[-278087,-15462259,-95303587],[-194879,-12203508,-114148483],[-169991,-13300363,-98059747],[-198071,-14045323,-96266347],[-184271,-15716188,-93313147],[-184679,-10539587,-101001763],[-167879,-15521179,-93409387],[-213839,-14103448,-99379963],[-166319,-14504956,-98700067],[-185471,-12955579,-96016243],[-187871,-16245883,-90381883],[-238271,-12186028,-102191923],[-182159,-16833979,-101799427],[-198239,-10010187,-98120947],[-204599,-14579788,-99136867],[-217031,-14260668,-93251827],[-195599,-16818643,-93892723],[-167639,-11983932,-93968323],[-240959,-16191323,-82200787],[-174719,-14223507,-100109563],[-183959,-14115163,-115572403],[-209831,-11653828,-101667883],[-174599,-16869451,-112768027],[-204671,-13199299,-111745363],[-218111,-17933611,-94282147],[-171071,-13069984,-99924883],[-219911,-15248059,-102300907],[-195719,-14879188,-101024683],[-231839,-18004291,-100108387],[-196031,-10495827,-123729643],[-220391,-17168491,-92653507],[-254399,-14544083,-101630323],[-180311,-15189571,-93658723],[-203111,-13701315,-103798963],[-226799,-17982403,-106911667],[-175031,-13706307,-115970563],[-263951,-17394019,-122110123],[-204239,-12414267,-104713603],[-178559,-14610028,-123302587],[-194039,-15174931,-107328307],[-374783,-17439388,-107673883],[-202319,-12499547,-108805027],[-317279,-18022012,-111289963],[-209711,-15427427,-106768027],[-241511,-15945619,-121074787],[-237551,-11145792,-123333907],[-232391,-17886859,-108258187],[-247511,-13535628,-115767283],[-360959,-17724683,-115900387],[-222719,-14188036,-112893883],[-213359,-16385251,-99772003],[-230831,-16122352,-115869427],[-207191,-17918987,-105030907],[-202991,-12006448,-130896187],[-227471,-18942379,-105568747],[-240191,-15933331,-109179403],[-193751,-16145131,-110698963],[-188471,-14036243,-119356603],[-264359,-19465603,-95480443],[-218951,-14687500,-113620123],[-207479,-18409763,-104572843],[-218231,-12173812,-124041523],[-263111,-17748652,-123226027],[-190319,-16384219,-119476963],[-250871,-20218411,-112086307],[-185279,-13210156,-119914267],[-219119,-18258811,-128754763],[-231791,-16879732,-110704147],[-202751,-16166243,-116303947],[-205271,-13400968,-126881227],[-191231,-17759227,-110771347],[-191351,-14805268,-116743243],[-287279,-17866747,-104312707],[-210311,-14902531,-122978923],[-243239,-17313587,-132978763],[-234911,-16893923,-119955067],[-218279,-20256619,-133009507],[-228791,-11368288,-129527227],[-257591,-19561771,-128940883],[-251039,-18018172,-138731107],[-226511,-17544427,-114716347],[-238391,-15117323,-120837907],[-235751,-19715611,-108167467],[-224279,-15004060,-130810387],[-265079,-19485628,-134009467],[-222239,-13764563,-131332723],[-199559,-18025324,-120924763],[-249959,-17853340,-117493387],[-298031,-19199419,-113809963],[-205631,-14432259,-133412203],[-257711,-20068339,-117333547],[-256511,-17285123,-112744003],[-320591,-18371308,-116996947],[-221231,-13145808,-138462283],[-248351,-20327179,-134919163],[-245159,-15985588,-121759243],[-280199,-21809443,-113957083],[-248519,-15534940,-130665907],[-223439,-18066028,-128744947],[-234071,-17600027,-130028347],[-276839,-20704507,-125669923],[-225599,-13458347,-132967003],[-260399,-20361139,-103500763],[-302231,-18491659,-122373043],[-235199,-19022092,-131987563],[-224111,-16403188,-130653307],[-211559,-20074843,-123916123],[-298751,-16662832,-137933203],[-231479,-22244476,-123585067],[-233999,-13330819,-129667987],[-284831,-18983467,-139553107],[-346031,-17723899,-124203643],[-298679,-22137067,-128545267],[-212159,-15450172,-133243147],[-217439,-22282339,-141568123],[-264911,-18777667,-135520627],[-249311,-19342483,-125113003],[-201431,-14970472,-121359067],[-238031,-21178411,-120725707],[-232151,-16517867,-140273827],[-228359,-20280523,-158712283],[-267119,-17029588,-150164683],[-388319,-19729427,-119515027],[-238871,-18812947,-120762427],[-279551,-21097963,-124839163],[-236759,-13627107,-149560387],[-467399,-21160963,-119386507],[-230711,-18991563,-145139443],[-257351,-19742059,-125709907],[-242759,-17611947,-147244843],[-225671,-21223651,-119795083],[-271319,-17693656,-140712643],[-382919,-23848651,-138663163],[-230879,-15568491,-141827827],[-316391,-19844179,-130788067],[-273479,-19970152,-125508307],[-251159,-22895491,-136016827],[-238559,-15787459,-141542347],[-289439,-23391211,-134317243],[-266591,-20074443,-124521763],[-236519,-21061603,-151992787],[-239951,-14022528,-139592707],[-282959,-22508923,-130835203],[-300551,-17804428,-134911723],[-334991,-23538379,-144622003],[-274559,-17744163,-141715267],[-255239,-19607212,-144136987],[-274511,-20282659,-171583003],[-336599,-22403131,-131605027],[-246791,-15613907,-156666283],[-253679,-22918219,-130381843],[-239399,-20399083,-127523467],[-262391,-20220451,-146713627],[-262631,-18108379,-144857707],[-335999,-24103291,-157251763],[-290111,-18145768,-151364467],[-269519,-23067619,-149412547],[-344351,-15557052,-153583123],[-479879,-21257212,-135323203],[-266279,-21333372,-135386227],[-267959,-24645091,-151867123],[-310631,-17009259,-150568147],[-273719,-25076027,-131212603],[-256871,-20526523,-155098507],[-285071,-20855059,-156770947],[-254999,-16660228,-155127043],[-551951,-23189251,-154427827],[-246671,-19040643,-157030603],[-454991,-25792531,-147054763],[-293471,-19110019,-157010107],[-302111,-21716963,-141556963],[-345959,-20824339,-162052507],[-255191,-26316307,-150892267],[-257039,-14574411,-154728667],[-306479,-23820163,-156729763],[-386759,-21900003,-156788923],[-354791,-22436747,-143231467],[-288791,-19111888,-150667603],[-261791,-26043883,-168852643],[-277079,-20121707,-165466723],[-306239,-27506659,-151351363],[-314639,-17635827,-168498163],[-265151,-20717947,-159884587],[-313799,-21981067,-155884243],[-250799,-25154971,-149457163],[-338519,-18254988,-165368107],[-297359,-22784803,-147558643],[-319751,-22538392,-150755467],[-378671,-23642092,-144444787],[-239279,-16793560,-154570483],[-291191,-24440179,-170094787],[-286919,-19428892,-167483563],[-267671,-25335883,-145024147],[-325415,-20123368,-163300867],[-305231,-23132267,-159212827],[-281111,-22538899,-172234987],[-580031,-26164267,-149610547],[-270479,-17264560,-175172083],[-440711,-28933939,-139898467],[-264239,-23500283,-162481603],[-327479,-23562499,-186445603],[-250631,-20429788,-163956307],[-395111,-27202099,-162226387],[-259871,-20951563,-199362403],[-368471,-26968099,-161831443],[-286079,-16060252,-176301283],[-391151,-23934619,-171987883],[-329159,-23677912,-176576107],[-361919,-26488051,-175001803],[-299519,-19028875,-180619363],[-417191,-27287539,-165055867],[-320711,-23642932,-169183723],[-300431,-24936523,-188330563],[-324191,-19137592,-186893107],[-322871,-28152259,-176649883],[-396791,-21671131,-177192163],[-415631,-24698731,-144604387],[-373295,-21317512,-182873923],[-363719,-24489643,-190884523],[-308831,-23750140,-149830627],[-290351,-27940723,-151140907],[-296999,-17245252,-182782867],[-357671,-27475891,-164274427],[-390719,-23346019,-180311107],[-342599,-25453843,-173473987],[-280271,-21202947,-175164763],[-307919,-27508163,-173215387],[-277031,-21203059,-178123003],[-303551,-30213067,-200171203],[-304079,-19673731,-181585867],[-340919,-26074588,-185482243],[-348071,-24894427,-179396947],[-450479,-27412843,-186800443],[-311519,-20420772,-189366907],[-314159,-27862699,-164446027],[-349151,-25051371,-179345203],[-364031,-25146892,-181811947],[-360191,-17674372,-166976947],[-283799,-29583772,-195829363],[-277679,-22927444,-193552507],[-475271,-27820603,-197092963],[-316151,-21961339,-185691643],[-317831,-25295548,-170043547],[-349751,-24744923,-194283763],[-336551,-29501299,-164219323],[-305399,-18666675,-177801187],[-366239,-28892011,-190038643],[-362039,-24722227,-181203163],[-293999,-26108188,-217576027],[-311351,-22852408,-182332483],[-302279,-29052508,-193411003],[-381671,-23180140,-174986947],[-284231,-29714491,-187231003],[-350831,-19258995,-175885627],[-350159,-25877227,-169102627],[-292991,-25588828,-164579683],[-291359,-28206748,-155836003],[-373511,-21401043,-188515387],[-345791,-29499859,-172005667],[-351911,-26553843,-186089443],[-325079,-25849468,-191676643],[-376031,-21093640,-198435427],[-437111,-30871171,-171620443],[-352439,-23034619,-179832907],[-379679,-30441331,-180282523],[-364199,-23193355,-219600907],[-413951,-27990139,-181968403],[-426719,-26642563,-195129643],[-405719,-30670483,-210971083],[-338351,-18068115,-194302483],[-383759,-28585699,-213119083],[-373799,-26446579,-186475963],[-289511,-27197932,-205377547],[-313871,-23421088,-196168603],[-325751,-31727923,-223175803],[-355631,-24189003,-186210523],[-600959,-31285651,-164793787],[-332111,-21737668,-195549187],[-382751,-27544651,-193969147],[-336839,-27308003,-194987083],[-494591,-33358219,-198318283],[-351119,-21686260,-217569643],[-348911,-30439267,-177983227],[-301391,-27128308,-195723067],[-376631,-27589459,-184039507],[-341519,-20481288,-206802523],[-389399,-30260803,-204361987],[-353279,-25249075,-209362147],[-353471,-33658972,-181428307],[-348311,-25230243,-209045467],[-341879,-27731068,-199180507],[-452399,-28015107,-199060843],[-381911,-31430011,-188697763],[-355319,-21271515,-224296867],[-369071,-34029547,-201556987],[-313199,-27112051,-181997467],[-452759,-28553627,-203540803],[-408239,-25180707,-224315947],[-322559,-31067923,-226134283],[-396431,-24980848,-225045283],[-327071,-31948003,-185039563],[-307271,-20330836,-203122627],[-454079,-26658172,-202384603],[-323111,-28507516,-215796667],[-330431,-32381659,-178294747],[-315839,-23367051,-227932027],[-539783,-31270339,-192419467],[-482279,-28196043,-207530107],[-360071,-29411491,-185271403],[-412079,-23519868,-220287043]];

procedure TestCMDiscriminant(:B:=1000)
    start := Cputime();
    R<x> := PolynomialRing(Integers());
    DD := [-d:d in [3..B]|IsDiscriminant(-d)];
    printf "Checking H_D(x),H_D(x+1),H_D(x+1) for |D| <= %o", B; timer := Cputime();
    for D in DD do
        H := HilbertClassPolynomial(D);
        assert CMDiscriminant(H) eq D;
        assert CMDiscriminant(Evaluate(H,x+1)) eq 0;
        assert CMDiscriminant(H+1) eq 0;
        printf ".";
    end for;
    t0 := Cputime();
    printf "\nVerified all discriminants |D| <= %o in %.3os\n", B, t0-start;

    printf "Checking H_D(x),H_D(x+1),H_D(x+1) for D with class group C2^n;\n";
    for D in AbelianD do
        H := HilbertClassPolynomial(D);
        assert CMDiscriminant(H) eq D;
        assert CMDiscriminant(Evaluate(H,x+1)) eq 0;
        assert CMDiscriminant(H+1) eq 0;
    end for;
    t1 := Cputime();
    printf "Verified abelian discriminants in %.3os\n", t1-t0;

    printf "Checking H_D(x),H_D(x)+1 for D of class number 5,10,15,20,25,50,75,100,...,1000;\n";
    DD := [r[2]:r in DD1000[[5..50 by 5]]] cat [r[2]:r in DD1000[[75]]] cat DD1000[100] cat [r[2]:r in DD1000[[125..1000 by 25]]];
    for D in DD do
        H := HilbertClassPolynomial(D);
        t1 := Cputime(); assert CMDiscriminant(H) eq D; t1 := Cputime()-t1;
        t2 := Cputime(); assert CMDiscriminant(H+1) eq 0; t2 := Cputime()-t2;
        printf "h(%o)=%o: %.3os & %.3os & %.3oGB\n",D,ClassNumber(D),t1,t2,1.0*GetMaximumMemoryUsage()/2^30;
    end for;
    printf "All tests completed successfully, total time %.3os\n", Cputime()-start;
end procedure;
